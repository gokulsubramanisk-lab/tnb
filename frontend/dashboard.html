<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Digital Notice Board</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <i class="fas fa-clipboard-list"></i>
          <span>Notice Board</span>
        </div>
        <button class="close-sidebar" onclick="toggleSidebar()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="user-info">
        <div class="user-avatar" id="userAvatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-details">
          <h4 id="userName">User Name</h4>
          <span class="user-role" id="userRole">Role</span>
          <span class="user-dept" id="userDept">Department</span>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <a href="#" class="nav-item active" data-page="notices">
          <i class="fas fa-bell"></i>
          <span>All Notices</span>
          <span class="badge" id="noticeCount">0</span>
        </a>
        <a href="#" class="nav-item" data-page="bookmarks">
          <i class="fas fa-bookmark"></i>
          <span>Bookmarks</span>
        </a>
        <a href="#" class="nav-item create-notice-btn" data-page="create" id="createNoticeNav" style="display: none;">
          <i class="fas fa-plus-circle"></i>
          <span>Create Notice</span>
        </a>
        <a href="#" class="nav-item" data-page="my-notices" id="myNoticesNav" style="display: none;">
          <i class="fas fa-file-alt"></i>
          <span>My Notices</span>
        </a>
        <a href="#" class="nav-item" data-page="analytics" id="analyticsNav" style="display: none;">
          <i class="fas fa-chart-bar"></i>
          <span>Analytics</span>
        </a>
        <a href="#" class="nav-item" data-page="manage-users" id="manageUsersNav" style="display: none;">
          <i class="fas fa-users-cog"></i>
          <span>Manage Users</span>
        </a>
      </nav>
      
      <div class="sidebar-footer">
        <a href="#" class="nav-item" data-page="settings">
          <i class="fas fa-cog"></i>
          <span>Settings</span>
        </a>
        <a href="#" class="nav-item logout" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Logout</span>
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <button class="menu-toggle" onclick="toggleSidebar()">
          <i class="fas fa-bars"></i>
        </button>
        
        <div class="search-bar">
          <i class="fas fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search notices...">
        </div>
        
        <div class="header-actions">
          <div class="notification-bell" onclick="toggleNotifications()">
            <i class="fas fa-bell"></i>
            <span class="notification-count" id="notificationCount">0</span>
          </div>
          
          <div class="theme-toggle" onclick="toggleTheme()">
            <i class="fas fa-moon" id="themeIcon"></i>
          </div>
          
          <div class="header-user" onclick="toggleUserMenu()">
            <span id="headerUserName">User</span>
            <i class="fas fa-chevron-down"></i>
          </div>
        </div>
        
        <!-- Notifications Dropdown -->
        <div class="notifications-dropdown" id="notificationsDropdown" style="display: none;">
          <h4>Notifications</h4>
          <div class="notifications-list" id="notificationsList">
            <p class="no-notifications">No new notifications</p>
          </div>
        </div>
        
        <!-- User Menu Dropdown -->
        <div class="user-menu-dropdown" id="userMenuDropdown" style="display: none;">
          <a href="#" data-page="profile"><i class="fas fa-user"></i> Profile</a>
          <a href="#" data-page="settings"><i class="fas fa-cog"></i> Settings</a>
          <hr>
          <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content-area" id="contentArea">
        <!-- Notices Page -->
        <div class="page active" id="noticesPage">
          <div class="page-header">
            <h2>All Notices</h2>
            <div class="filters">
              <select id="categoryFilter" class="filter-select">
                <option value="all">All Categories</option>
                <option value="general">General</option>
                <option value="academic">Academic</option>
                <option value="event">Events</option>
                <option value="exam">Exams</option>
                <option value="placement">Placement</option>
                <option value="sports">Sports</option>
                <option value="cultural">Cultural</option>
              </select>
              
              <select id="priorityFilter" class="filter-select">
                <option value="all">All Priorities</option>
                <option value="urgent">Urgent</option>
                <option value="high">High</option>
                <option value="normal">Normal</option>
                <option value="low">Low</option>
              </select>
              
              <select id="tagFilter" class="filter-select">
                <option value="all">All Departments</option>
                <option value="cse">@CSE</option>
                <option value="ece">@ECE</option>
                <option value="eee">@EEE</option>
                <option value="civil">@Civil</option>
                <option value="mech">@Mech</option>
              </select>
            </div>
          </div>
          
          <div class="notices-grid" id="noticesGrid">
            <!-- Notices will be loaded here -->
          </div>
          
          <div class="pagination" id="pagination">
            <!-- Pagination will be loaded here -->
          </div>
        </div>

        <!-- Create Notice Page -->
        <div class="page" id="createPage">
          <div class="page-header">
            <h2>Create New Notice</h2>
          </div>
          
          <form id="createNoticeForm" class="notice-form" enctype="multipart/form-data">
            <div class="form-row">
              <div class="form-group">
                <label for="noticeTitle">Title *</label>
                <input type="text" id="noticeTitle" name="title" required placeholder="Enter notice title">
              </div>
            </div>
            
            <div class="form-group">
              <label for="noticeContent">Content *</label>
              <textarea id="noticeContent" name="content" rows="6" required placeholder="Enter notice content"></textarea>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="targetAudience">Target Audience *</label>
                <select id="targetAudience" name="targetAudience" required>
                  <option value="all">All (Students & Faculty)</option>
                  <option value="students">Students Only</option>
                  <option value="faculty" id="facultyOption">Faculty Only</option>
                  <option value="both" id="bothOption">Both</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="noticeCategory">Category</label>
                <select id="noticeCategory" name="category">
                  <option value="general">General</option>
                  <option value="academic">Academic</option>
                  <option value="event">Event</option>
                  <option value="exam">Exam</option>
                  <option value="placement">Placement</option>
                  <option value="sports">Sports</option>
                  <option value="cultural">Cultural</option>
                  <option value="other">Other</option>
                </select>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="noticePriority">Priority</label>
                <select id="noticePriority" name="priority">
                  <option value="normal">Normal</option>
                  <option value="low">Low</option>
                  <option value="high">High</option>
                  <option value="urgent">Urgent</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="expiryDays">Expiry (Days) *</label>
                <input type="number" id="expiryDays" name="expiryDays" min="1" max="365" value="7" required>
              </div>
            </div>
            
            <div class="form-group">
              <label>Tags (Departments) *</label>
              <div class="tags-selection">
                <label class="tag-checkbox">
                  <input type="checkbox" name="tags" value="all" checked>
                  <span class="tag-label">@all</span>
                </label>
                <label class="tag-checkbox">
                  <input type="checkbox" name="tags" value="cse">
                  <span class="tag-label">@cse</span>
                </label>
                <label class="tag-checkbox">
                  <input type="checkbox" name="tags" value="ece">
                  <span class="tag-label">@ece</span>
                </label>
                <label class="tag-checkbox">
                  <input type="checkbox" name="tags" value="eee">
                  <span class="tag-label">@eee</span>
                </label>
                <label class="tag-checkbox">
                  <input type="checkbox" name="tags" value="civil">
                  <span class="tag-label">@civil</span>
                </label>
                <label class="tag-checkbox">
                  <input type="checkbox" name="tags" value="mech">
                  <span class="tag-label">@mech</span>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label for="attachments">Attachments (Max 5 files, 10MB each)</label>
              <div class="file-upload">
                <input type="file" id="attachments" name="attachments" multiple accept=".jpg,.jpeg,.png,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx">
                <div class="file-upload-label">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <span>Drag & drop files or click to browse</span>
                </div>
              </div>
              <div class="file-list" id="fileList"></div>
            </div>
            
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="isPinned" name="isPinned">
                <span>Pin this notice (appears at top)</span>
              </label>
            </div>
            
            <div class="form-actions">
              <button type="button" class="btn btn-secondary" onclick="showPage('notices')">Cancel</button>
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-paper-plane"></i> Publish Notice
              </button>
            </div>
          </form>
        </div>

        <!-- My Notices Page -->
        <div class="page" id="myNoticesPage">
          <div class="page-header">
            <h2>My Notices</h2>
          </div>
          <div class="notices-grid" id="myNoticesGrid">
            <!-- My notices will be loaded here -->
          </div>
        </div>

        <!-- Bookmarks Page -->
        <div class="page" id="bookmarksPage">
          <div class="page-header">
            <h2>Bookmarked Notices</h2>
          </div>
          <div class="notices-grid" id="bookmarksGrid">
            <!-- Bookmarked notices will be loaded here -->
          </div>
        </div>

        <!-- Analytics Page -->
        <div class="page" id="analyticsPage">
          <div class="page-header">
            <h2>Analytics Dashboard</h2>
          </div>
          <div class="analytics-grid">
            <div class="stat-card">
              <div class="stat-icon blue">
                <i class="fas fa-file-alt"></i>
              </div>
              <div class="stat-info">
                <h3 id="totalNotices">0</h3>
                <p>Total Notices</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon green">
                <i class="fas fa-check-circle"></i>
              </div>
              <div class="stat-info">
                <h3 id="activeNotices">0</h3>
                <p>Active Notices</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon orange">
                <i class="fas fa-clock"></i>
              </div>
              <div class="stat-info">
                <h3 id="expiredNotices">0</h3>
                <p>Expired Notices</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon purple">
                <i class="fas fa-users"></i>
              </div>
              <div class="stat-info">
                <h3 id="totalUsers">0</h3>
                <p>Total Users</p>
              </div>
            </div>
          </div>
          
          <div class="charts-grid">
            <div class="chart-card">
              <h4>Notices by Category</h4>
              <div class="chart-container" id="categoryChart"></div>
            </div>
            <div class="chart-card">
              <h4>Notices by Department</h4>
              <div class="chart-container" id="departmentChart"></div>
            </div>
            <div class="chart-card">
              <h4>Priority Distribution</h4>
              <div class="chart-container" id="priorityChart"></div>
            </div>
            <div class="chart-card">
              <h4>Recent Notices</h4>
              <div class="recent-list" id="recentNoticesList"></div>
            </div>
          </div>
        </div>

        <!-- Manage Users Page -->
        <div class="page" id="manageUsersPage">
          <div class="page-header">
            <h2>Manage Users</h2>
            <div class="header-actions-inline">
              <button class="btn btn-primary" onclick="showAddUserModal()">
                <i class="fas fa-plus"></i> Add User
              </button>
              <button class="btn btn-secondary" onclick="showUploadUsersModal()">
                <i class="fas fa-file-excel"></i> Upload Excel
              </button>
            </div>
          </div>
          
          <div class="users-filters">
            <select id="userRoleFilter" onchange="loadUsers()">
              <option value="">All Roles</option>
              <option value="student">Students</option>
              <option value="faculty">Faculty</option>
              <option value="hod">HOD</option>
            </select>
            <select id="userDeptFilter" onchange="loadUsers()">
              <option value="">All Departments</option>
              <option value="cse">CSE</option>
              <option value="ece">ECE</option>
              <option value="eee">EEE</option>
              <option value="civil">Civil</option>
              <option value="mech">Mech</option>
            </select>
          </div>
          
          <div class="users-table-container">
            <table class="users-table">
              <thead>
                <tr>
                  <th>User ID</th>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Department</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="usersTableBody">
                <!-- Users will be loaded here -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Settings Page -->
        <div class="page" id="settingsPage">
          <div class="page-header">
            <h2>Settings</h2>
          </div>
          
          <div class="settings-sections">
            <div class="settings-section">
              <h3><i class="fas fa-user"></i> Profile Settings</h3>
              <form id="profileForm" class="settings-form">
                <div class="form-group">
                  <label>Name</label>
                  <input type="text" id="settingsName" name="name">
                </div>
                <div class="form-group">
                  <label>Phone</label>
                  <input type="text" id="settingsPhone" name="phone">
                </div>
                <button type="submit" class="btn btn-primary">Update Profile</button>
              </form>
            </div>
            
            <div class="settings-section">
              <h3><i class="fas fa-lock"></i> Change Password</h3>
              <form id="passwordForm" class="settings-form">
                <div class="form-group">
                  <label>Current Password</label>
                  <input type="password" id="currentPassword" name="currentPassword" required>
                </div>
                <div class="form-group">
                  <label>New Password</label>
                  <input type="password" id="newPassword" name="newPassword" required>
                </div>
                <div class="form-group">
                  <label>Confirm New Password</label>
                  <input type="password" id="confirmPassword" name="confirmPassword" required>
                </div>
                <button type="submit" class="btn btn-primary">Change Password</button>
              </form>
            </div>
            
            <div class="settings-section">
              <h3><i class="fas fa-bell"></i> Notification Preferences</h3>
              <div class="notification-settings">
                <label class="toggle-setting">
                  <span>Email Notifications</span>
                  <input type="checkbox" id="emailNotifications" checked>
                  <span class="toggle-slider"></span>
                </label>
                <label class="toggle-setting">
                  <span>Push Notifications</span>
                  <input type="checkbox" id="pushNotifications" checked>
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Notice Detail Modal -->
  <div class="modal" id="noticeModal">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h3 id="modalNoticeTitle">Notice Title</h3>
        <button class="modal-close" onclick="closeModal('noticeModal')">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body" id="modalNoticeBody">
        <!-- Notice details will be loaded here -->
      </div>
    </div>
  </div>

  <!-- Add User Modal -->
  <div class="modal" id="addUserModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add New User</h3>
        <button class="modal-close" onclick="closeModal('addUserModal')">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="addUserForm">
          <div class="form-group">
            <label>User ID *</label>
            <input type="text" id="newUserId" required>
          </div>
          <div class="form-group">
            <label>Name *</label>
            <input type="text" id="newUserName" required>
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input type="email" id="newUserEmail" required>
          </div>
          <div class="form-group">
            <label>Password *</label>
            <input type="password" id="newUserPassword" required>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Role *</label>
              <select id="newUserRole" required>
                <option value="student">Student</option>
                <option value="faculty">Faculty</option>
                <option value="hod">HOD</option>
              </select>
            </div>
            <div class="form-group">
              <label>Department *</label>
              <select id="newUserDept" required>
                <option value="cse">CSE</option>
                <option value="ece">ECE</option>
                <option value="eee">EEE</option>
                <option value="civil">Civil</option>
                <option value="mech">Mech</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input type="text" id="newUserPhone">
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="closeModal('addUserModal')">Cancel</button>
            <button type="submit" class="btn btn-primary">Add User</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Upload Users Modal -->
  <div class="modal" id="uploadUsersModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Upload Users from Excel</h3>
        <button class="modal-close" onclick="closeModal('uploadUsersModal')">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="upload-instructions">
          <h4>Excel Format Requirements:</h4>
          <p>Your Excel file should have the following columns:</p>
          <ul>
            <li><strong>userId</strong> - Unique user ID</li>
            <li><strong>name</strong> - Full name</li>
            <li><strong>email</strong> - Email address</li>
            <li><strong>password</strong> - Initial password</li>
            <li><strong>role</strong> - student/faculty/hod</li>
            <li><strong>department</strong> - cse/ece/eee/civil/mech</li>
            <li><strong>phone</strong> - Phone number (optional)</li>
          </ul>
        </div>
        <form id="uploadUsersForm" enctype="multipart/form-data">
          <div class="form-group">
            <div class="file-upload">
              <input type="file" id="excelFile" name="file" accept=".xlsx,.xls" required>
              <div class="file-upload-label">
                <i class="fas fa-file-excel"></i>
                <span>Click to upload Excel file</span>
              </div>
            </div>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="closeModal('uploadUsersModal')">Cancel</button>
            <button type="submit" class="btn btn-primary">Upload Users</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="spinner"></div>
  </div>

  <script src="js/dashboard.js"></script>
</body>
</html>